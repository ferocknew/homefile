<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Ajax无刷新上传--艾恩Asp无组件上传</title>
    <script type="text/javascript" src="js/AnPlus.js"></script>
    <script type="text/javascript" src="js/AjaxUploader.js"></script>
</head>
<body>
    <div style="line-height:17px;font-size:10pt;">
	上传文件的普通示例2--显示上传信息到DIV
    </div>
    <hr />
<div id="detialMsg" style ="padding:5px;border:1px #ddd solid;background-color:#eee;width:500px;margin:5px;"></div>
<!--下面的内容是你必须要做的-->
<div id="uploadContenter"></div>
<iframe style="display:none;" name="AnUploader"></iframe>
<script type="text/javascript">
	//创建Uploader，参数Contenter	字符串	上传控件的容器，程序自动给容易四面增加3px的padding
	var AjaxUp=new AjaxProcesser("uploadContenter");
	
	//设置提交到的iframe名称
	AjaxUp.target="AnUploader";  
	
	//上传处理页面
	AjaxUp.url="upload.asp"; 
	
	//保存目录
	AjaxUp.savePath="_upload";  
	
	//上传成功时运行的程序
	AjaxUp.succeed=function(files){
		//下面遍历所有的文件，files是一个数组，数组元素的数目就是上传文件的个数，每个元素包含的信息为文件名字和文件大小
		var info="";
		info="本次共上传" + files.length + "个文件;<br />"
		for(var i=0;i<files.length;i++){
			info+=("文件"+ (i+1) +" 名称:" + files[i].name + "大小:" + files[i].size + "<br />");
		}
		Ai("detialMsg").html(info); //类似于innerHTML方法
	}
	
	//上传失败时运行的程序
	AjaxUp.faild=function(msg){
		alert("失败原因:" + msg)
	}
</script>
<!--你已经做完你的工作了-->
</body>
</html>
