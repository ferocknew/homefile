<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Untitled Document</title>
        <link type="text/css" rel="stylesheet" href='js/paging.css'/>
        <script language="JavaScript" type="text/javascript" src="../lib/jquery-1.3.2.min.js">
        </script>
        <script language="JavaScript" type="text/javascript" src="js/widget.js">
        </script>
        <script language="JavaScript" type="text/javascript" src="js/paging.js">
        </script>
        <script language="JavaScript" type="text/javascript">
            $(function(){
                //分页
                $("#mynews").paging({
                    loadPages: showResult,
                    perpage: 3, //单页显示记录数
                    autoPage: 1, //起始页码
                    jumpAble: 0, //是否含有跳转框
                });
                
                //loadPage 动作
                function showResult(pageIndex){
                    var self = this;
                    //确认是否初始化
                    if (self.initFlag !== true) {
                        $.get("data/dir.xml", function(data_xml){
                            self.nodes = $("Path_dir", data_xml);
                            self.totalnum = self.nodes.length; //总记录数
                            self.initNav(); //初始化
                            self.initFlag = true; //设置调试属性
                            parsePage(self, pageIndex); //构建html显示
                        });
                    }
                    // 翻页循环
                    else {
                        parsePage(self, pageIndex);
                    };
                    
                        };
                // 构建html代码，pageIndex：页码
                function parsePage(self, pageIndex){
                    self.setNav(pageIndex); //获取页码
                    var from = (pageIndex - 1) * self.perpage, end = from + self.perpage; //计算每页头尾 item 计数器值
                    var items = self.nodes.slice(from, end); //获取数据片段
                    var html = '<ul>';                    
                    items.each(function(){
                        html += '<li>' + $(this).attr("name") + '</li>';
                    });
                    html += "</ul>";
                    $(".pagebody").html(html);
                };
                });
        </script>
    </head>
    <body>
        <div id="mynews" class="pages">
            <div class="pagebody">
            </div>
            <div class="pagenav">
            </div>
        </div>
    </body>
</html>
